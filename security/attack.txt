### 攻撃の概要と対策 ###

【クロスサイトスクリプティング(XSS)】
脆弱性のある WEB サイトを使って、
ユーザのブラウザで悪意のあるスクリプトを実行させる攻撃。
掲示板サイトやアンケートサイトなどが罠リンクを仕掛ける踏み台として利用される。

＊攻撃方法
攻撃者は掲示板サイトに罠リンクを仕掛けたり、罠リンクを含むメールをターゲットに送信することで、
脆弱性のある WEB サイトに誘導。
リンクには不正なスクリプトが含まれており、罠リンクをクリックしたターゲットは
脆弱性のあるWEB サイトに移動すると同時に不正なスクリプトを実行。
その結果、ターゲットには偽の情報が表示されたり、スクリプトによって
ターゲットのCookieの情報が流出する危険性がある。

XSS による被害が発生した場合, 脆弱な WEB サイトを放置している管理
者の責任が問われる場合がある。

＊対策
・エスケープ処理（WEBサーバ側で意図しないスクリプトを実行しない）
  エスケープ処理とは、HTML で特別な意味をもつ記号を、特別な意味をもたないように変換すること。
  特別な意味をもたない文字に変更することで、無害化 (サニタイジング) できる。

・HTTPレスポンスヘッダのContent-Typeフィールドの文字コードを指定する

・X-XSS-Protection
  反射型XSSを検出した時にページの読み込みを停止

・Content-Security-Policy
  スクリプトの読み込みを許可するドメインをポリシとして指定

・HttpOnly属性
  CookieにHttpOnly属性を設定し、「document.cookie」を用いてアクセスすることを禁止する。

＊DOM-based XSSの対策
・「document.write」や「innerHTML」等のメソッドやプロパティを使わず、
  「createElement」等のDOM操作用のメソッドやプロパティを使うようにする。


【クロスサイトリクエストフォージェリ(CSRF)】
悪意のあるスクリプトを埋め込んだWebページを訪問者に閲覧させて、
利用者認証やセッション管理の脆弱性のある別のWebサイトで、
その訪問者が意図しない操作（ショッピングでの決済・退会等）を行わせる攻撃

＊対策
・秘密情報(ページトークン)による認証
・パスワードの再入力
・参照元情報(Referrer:リファラ)の検証


【クリックジャッキング攻撃】
iframeなどで透明化したレイヤに標的サイトのコンテンツを重ねて配置し、不正な操作を実行させる攻撃。

＊対策
・Webサイト側がHTTPレスポンスヘッダにX-Frame-Optionを含める
  frameまたはiframeでページを表示する可否を指定する仕組み

・Webサイト側がHTTPレスポンスヘッダにContent-Security-Policyを含める
  frameまたはiframeでページを表示するドメインを限定する仕組み


【SQLインジェクション】
不正なSQL文を入力することでDBを操作したり、個人情報などを不正に取得したりする攻撃。

＊対策
・バインド機構の使用
・入力データのエスケープ処理
・WAF
・RDBMSのアクセス権限設定
・Webサーバのエラーメッセージをクライアントに送らない


【OSコマンドインジェクション】
アプリケーションの入力フィールドなどを介して不正なOSコマンドを挿入し、実行する攻撃。

＊対策
・入力データに使用可能な文字種や書式の明確化
・上記ルールをチェックし、ルールに従わないデータはエラーとする。
・WAF


【Smurf】
Pingの仕組みを利用して、相手のコンピュータやネットワークに大量のパケットを送りつけるDOS攻撃の一種。
送信元IP：ターゲットのIPアドレス
宛先IP：ブロードキャストアドレス
ブロードキャストドメインに含まれる大量の機器がターゲットにPing応答を返す。

＊対策
・ルータやファイヤーウォールでICMPパケットを遮断する。
・ルーターやスイッチでICMPパケットの帯域制限を行う
・ブロードキャストアドレス宛のパケットを遮断する


【リフレクタ攻撃】
送信元IPアドレスを攻撃対象のサーバに偽装した問い合わせパケットを利用して、
大量の攻撃パケットを攻撃対象に集中させ、過負荷状態にすることでサービス停止に追い込むDOS攻撃。

＊対策
・オープンリゾルバを停止する
・送信元のIPアドレスを検証する
・キャッシュサーバを別にする


【サイドチャネル攻撃】
処理時間や消費電力量、エラーメッセージなどのサイドチャネル情報から、
機密情報や暗号鍵の推定等を試みる行為。


【ダウングレード攻撃】
SSL/TLSの通信開始時、脆弱性のあるSSL/TLSのバージョン若しくは強度の弱い暗号化アルゴリズム・鍵交換アルゴリズムの
使用を強制することで、通信傍受などを行う攻撃。
この攻撃が成立するためには中間者攻撃ができるようになっている必要がある。


【パスワードスプレー攻撃】
アカウントロックを回避しながらパスワードを複数の利用者IDに同時に試し、ログインを試行すること。

【暗号解読法】
・ブルートフォース攻撃(総当たり)
・既知平文攻撃(攻撃者が暗号文とそれに対応する平文の組を持っている)
・選択平文攻撃(攻撃者が平文を選択し、その平文を暗号化アルゴリズムに渡し、それによって生成された暗号文を収集)
・差分解読法(平文と暗号文の差を利用)
・線形解読法(線形近似式を利用)